--[[
    Library  |  Insert = open/close

    Components:
        Window:AddTab(name)
        Tab:AddSection(name, "Left"/"Right")
        Section:AddSubTabs({names})
        Section:AddToggle(label, default, cb, swatchColor, onSwatchChange)
        Section:AddToggle2(label, default, cb, {{color=Color3, cb=fn}, ...})
        Section:AddSlider(label, min, max, default, cb, suffix)
        Section:AddDropdown(label, {opts}, default, cb)
        Section:AddMultibox(label, {opts}, {defaults}, cb)
        Section:AddKeybind(label, default, cb)
        Section:AddColorPicker(label, Color3, cb)
        Section:AddButton(label, cb, danger)
        Section:AddLabel(text)
        Section:AddSeparator()
        Section:AddProfileList({names}, cb)
        Window:Dialog(msg, cb)

    SubTabs:
        local sub  = Section:AddSubTabs({"Tab1","Tab2"})
        local t1   = sub:Tab("Tab1")
        local t2   = sub:Tab("Tab2")
        t1:AddToggle(...)
        t2:AddSlider(...)

    Notify:
        Library.Notify(text, position, duration)
        position = "Top" | "Bottom" | "Left" | "Right"
]]

local TS  = game:GetService("TweenService")
local UIS = game:GetService("UserInputService")
local CG  = game:GetService("CoreGui")

local FONT
do
    local ok = pcall(function()
        local aid = "SmallestPixel.ttf"
        if not isfile(aid) then
            writefile(aid, game:HttpGet(
                "https://raw.githubusercontent.com/onlymolyigoontofemboys/BETA/main/smallest_pixel-7.ttf"
            ))
        end
        FONT = Font.new(getcustomasset(aid))
    end)
    if not ok then FONT = Font.new("rbxasset://fonts/families/RobotoMono.json") end
end

local BG      = Color3.fromRGB(26,26,28)
local BG_H    = Color3.fromRGB(20,20,22)
local BG_ITEM = Color3.fromRGB(32,32,34)
local BG_IN   = Color3.fromRGB(18,18,20)
local ACC     = Color3.fromRGB(204,51,51)
local ACC_LT  = Color3.fromRGB(224,85,85)
local BOR     = Color3.fromRGB(50,50,52)
local TXT     = Color3.fromRGB(200,200,204)
local TXT_D   = Color3.fromRGB(95,95,99)
local TXT_H   = Color3.fromRGB(232,232,234)
local WHITE   = Color3.fromRGB(255,255,255)
local ADARK   = Color3.fromRGB(45,14,14)

local FAST = TweenInfo.new(0.15, Enum.EasingStyle.Quart, Enum.EasingDirection.Out)
local MED  = TweenInfo.new(0.22, Enum.EasingStyle.Quart, Enum.EasingDirection.Out)

local function tw(o, p, ti)
    TS:Create(o, ti or FAST, p):Play()
end

local function new(cl, props, parent)
    local o = Instance.new(cl)
    for k, v in pairs(props) do o[k] = v end
    if parent then o.Parent = parent end
    return o
end

local function corner(p, r)
    local c = Instance.new("UICorner")
    c.CornerRadius = UDim.new(0, r or 2)
    c.Parent = p
end

local function stroke(p, col, t)
    local s = Instance.new("UIStroke")
    s.Color = col or BOR; s.Thickness = t or 1
    s.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    s.Parent = p; return s
end

local function pad(p, t, b, l, r)
    local u = Instance.new("UIPadding")
    u.PaddingTop=UDim.new(0,t or 0); u.PaddingBottom=UDim.new(0,b or 0)
    u.PaddingLeft=UDim.new(0,l or 0); u.PaddingRight=UDim.new(0,r or 0)
    u.Parent = p
end

local function vlist(p, gap)
    local l = Instance.new("UIListLayout")
    l.FillDirection=Enum.FillDirection.Vertical
    l.SortOrder=Enum.SortOrder.LayoutOrder
    l.Padding=UDim.new(0,gap or 0); l.Parent=p; return l
end

local function hlist(p, gap)
    local l = Instance.new("UIListLayout")
    l.FillDirection=Enum.FillDirection.Horizontal
    l.SortOrder=Enum.SortOrder.LayoutOrder
    l.Padding=UDim.new(0,gap or 0); l.Parent=p; return l
end

local function makeSlider(track, fill, valLbl, minV, maxV, defV, sfx, cb, capParent)
    sfx = sfx or ""
    local val = math.clamp(defV or minV, minV, maxV)
    local dragging = false

    local function setVal(v)
        val = math.clamp(math.round(v * 10) / 10, minV, maxV)
        local t = (val - minV) / (maxV - minV)
        fill.Size   = UDim2.new(t, 0, 1, 0)
        valLbl.Text = tostring(val) .. sfx
        if cb then cb(val) end
    end
    setVal(val)

    local hit = new("TextButton", {
        Size=UDim2.new(1,0,0,18), Position=UDim2.new(0,0,0.5,-9),
        BackgroundTransparency=1, Text="", ZIndex=10,
    }, track)

    local capF = nil

    local function getX(x)
        local ax = track.AbsolutePosition.X
        local aw = track.AbsoluteSize.X
        if aw == 0 then return val end
        return minV + math.clamp((x - ax) / aw, 0, 1) * (maxV - minV)
    end

    hit.MouseButton1Down:Connect(function(mx)
        dragging = true
        setVal(getX(mx))
        if capF then capF:Destroy() end
        capF = new("Frame",{Size=UDim2.new(1,0,1,0),BackgroundTransparency=1,ZIndex=9999},capParent)
        capF.InputChanged:Connect(function(mi)
            if dragging and mi.UserInputType == Enum.UserInputType.MouseMovement then
                setVal(getX(mi.Position.X))
            end
        end)
        capF.InputEnded:Connect(function(mi)
            if mi.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = false; capF:Destroy(); capF = nil
            end
        end)
    end)

    UIS.InputEnded:Connect(function(i)
        if i.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
            if capF then capF:Destroy(); capF = nil end
        end
    end)

    local S = {}
    function S:Set(v) setVal(v) end
    function S:Get() return val end
    return S
end

local function openColorPicker(sg, swatchBtn, initColor, cb)
    local pendR, pendG, pendB = initColor.R, initColor.G, initColor.B

    local apos = swatchBtn.AbsolutePosition
    local asiz = swatchBtn.AbsoluteSize
    local pw   = 200
    local px   = apos.X + asiz.X + 8
    local py   = apos.Y - 10

    if px + pw > workspace.CurrentCamera.ViewportSize.X then
        px = apos.X - pw - 8
    end

    local pf = new("Frame",{
        Size=UDim2.new(0,pw,0,0), Position=UDim2.new(0,px,0,py),
        BackgroundColor3=BG_ITEM, BorderSizePixel=0,
        AutomaticSize=Enum.AutomaticSize.Y, ZIndex=300, ClipsDescendants=false,
    }, sg)
    corner(pf,3); stroke(pf,BOR,1)
    pad(pf,8,8,10,10); vlist(pf,6)

    local prevFr = new("Frame",{
        Size=UDim2.new(1,0,0,16), BackgroundColor3=initColor, BorderSizePixel=0, ZIndex=301,
    }, pf)
    corner(prevFr,2); stroke(prevFr,Color3.fromRGB(60,60,62),1)

    local channels = {
        {l="R", get=function() return pendR end, set=function(v) pendR=v end, col=Color3.fromRGB(200,50,50)},
        {l="G", get=function() return pendG end, set=function(v) pendG=v end, col=Color3.fromRGB(50,180,50)},
        {l="B", get=function() return pendB end, set=function(v) pendB=v end, col=Color3.fromRGB(60,100,220)},
    }

    for _, ch in ipairs(channels) do
        local cRow = new("Frame",{Size=UDim2.new(1,0,0,18),BackgroundTransparency=1,ZIndex=301},pf)
        new("TextLabel",{
            Size=UDim2.new(0,10,1,0), BackgroundTransparency=1,
            Text=ch.l, TextColor3=ch.col, FontFace=FONT, TextSize=10, ZIndex=302,
        },cRow)
        local ct = new("Frame",{
            Size=UDim2.new(1,-40,0,4), Position=UDim2.new(0,14,0.5,-2),
            BackgroundColor3=Color3.fromRGB(42,42,44), BorderSizePixel=0, ZIndex=302,
        },cRow)
        local cf = new("Frame",{Size=UDim2.new(ch.get(),0,1,0),BackgroundColor3=ch.col,BorderSizePixel=0,ZIndex=303},ct)
        local cl = new("TextLabel",{
            Size=UDim2.new(0,26,1,0), Position=UDim2.new(1,-26,0,-4),
            BackgroundTransparency=1, Text=tostring(math.round(ch.get()*255)),
            TextColor3=TXT_D, FontFace=FONT, TextSize=9, ZIndex=302,
        },cRow)
        local hit = new("TextButton",{
            Size=UDim2.new(1,0,0,18), Position=UDim2.new(0,0,0.5,-9),
            BackgroundTransparency=1, Text="", ZIndex=310,
        },ct)
        local capC = nil
        local dragging = false
        local function calcCol(x)
            local ax = ct.AbsolutePosition.X
            local aw = ct.AbsoluteSize.X
            if aw == 0 then return end
            local t = math.clamp((x-ax)/aw, 0, 1)
            ch.set(t); cf.Size=UDim2.new(t,0,1,0)
            cl.Text=tostring(math.round(t*255))
            prevFr.BackgroundColor3=Color3.new(pendR,pendG,pendB)
        end
        hit.MouseButton1Down:Connect(function(mx)
            dragging=true; calcCol(mx)
            if capC then capC:Destroy() end
            capC=new("Frame",{Size=UDim2.new(1,0,1,0),BackgroundTransparency=1,ZIndex=9999},sg)
            capC.InputChanged:Connect(function(mi)
                if dragging and mi.UserInputType==Enum.UserInputType.MouseMovement then calcCol(mi.Position.X) end
            end)
            capC.InputEnded:Connect(function(mi)
                if mi.UserInputType==Enum.UserInputType.MouseButton1 then
                    dragging=false; capC:Destroy(); capC=nil
                end
            end)
        end)
        UIS.InputEnded:Connect(function(i)
            if i.UserInputType==Enum.UserInputType.MouseButton1 then
                dragging=false
                if capC then capC:Destroy(); capC=nil end
            end
        end)
    end

    local applyBtn = new("TextButton",{
        Size=UDim2.new(1,0,0,22), BackgroundColor3=ADARK, BorderSizePixel=0,
        Text="Apply", TextColor3=ACC_LT, FontFace=FONT, TextSize=11,
        AutoButtonColor=false, ZIndex=301,
    },pf)
    corner(applyBtn,1); stroke(applyBtn,ACC,1)

    applyBtn.MouseButton1Click:Connect(function()
        if cb then cb(Color3.new(pendR,pendG,pendB)) end
        pf:Destroy()
    end)

    return function()
        if pf and pf.Parent then pf:Destroy() end
    end
end

local NotifySG
local ActiveNotifs = {}

local function ensureNSG()
    if NotifySG and NotifySG.Parent then return end
    NotifySG = new("ScreenGui",{
        Name="LibraryNotify", ResetOnSpawn=false,
        ZIndexBehavior=Enum.ZIndexBehavior.Sibling, DisplayOrder=999,
    }, CG)
end

local function reflow(pos)
    local off = 0
    for i = #ActiveNotifs, 1, -1 do
        local f  = ActiveNotifs[i]
        local fw = f.Size.X.Offset
        local fh = f.Size.Y.Offset
        local t
        if     pos=="Top"    then t=UDim2.new(0.5,-fw/2,0,14+off)
        elseif pos=="Bottom" then t=UDim2.new(0.5,-fw/2,1,-14-fh-off)
        elseif pos=="Left"   then t=UDim2.new(0,14,0.5,-fh/2-off)
        else                      t=UDim2.new(1,-fw-14,0.5,-fh/2-off)
        end
        tw(f,{Position=t},TweenInfo.new(0.2,Enum.EasingStyle.Quart,Enum.EasingDirection.Out))
        off = off + fh + 6
    end
end

local Library = {}

function Library.Notify(text, pos, dur)
    pos = pos or "Right"; dur = dur or 3.5
    ensureNSG()
    local up = text:upper()
    local dummy = new("TextLabel",{Size=UDim2.new(0,500,0,20),Text=up,FontFace=FONT,TextSize=13,Visible=false},NotifySG)
    local fw = math.max(80, dummy.TextBounds.X + 30)
    dummy:Destroy()
    local fh = 30

    local sp
    if     pos=="Top"    then sp=UDim2.new(0.5,-fw/2,0,-fh-10)
    elseif pos=="Bottom" then sp=UDim2.new(0.5,-fw/2,1,fh+10)
    elseif pos=="Left"   then sp=UDim2.new(0,-fw-10,0.5,-fh/2)
    else                      sp=UDim2.new(1,fw+10,0.5,-fh/2)
    end

    local fr = new("Frame",{
        Size=UDim2.new(0,fw,0,fh), Position=sp,
        BackgroundColor3=BG, BackgroundTransparency=0.08,
        BorderSizePixel=0, ClipsDescendants=true, ZIndex=100,
    }, NotifySG)
    corner(fr,2); stroke(fr,BOR,1)
    new("Frame",{Size=UDim2.new(0,2,1,0),BackgroundColor3=ACC,BorderSizePixel=0,ZIndex=101},fr)
    local lbl = new("TextLabel",{
        Size=UDim2.new(1,-14,1,0), Position=UDim2.new(0,10,0,0),
        BackgroundTransparency=1, Text="", TextColor3=TXT_H,
        FontFace=FONT, TextSize=13, TextXAlignment=Enum.TextXAlignment.Left, ZIndex=101,
    }, fr)
    local bar = new("Frame",{
        Size=UDim2.new(1,0,0,1), Position=UDim2.new(0,0,1,-1),
        BackgroundColor3=ACC, BorderSizePixel=0, ZIndex=102,
    }, fr)

    table.insert(ActiveNotifs, fr)
    reflow(pos)
    TS:Create(bar,TweenInfo.new(dur,Enum.EasingStyle.Linear),{Size=UDim2.new(0,0,0,1)}):Play()
    task.spawn(function()
        for i=1,#up do lbl.Text=string.sub(up,1,i); task.wait(0.025) end
    end)
    task.delay(dur, function()
        for i,v in ipairs(ActiveNotifs) do
            if v==fr then table.remove(ActiveNotifs,i); break end
        end
        reflow(pos)
        local ep
        local px2=fr.Position.X.Offset; local py2=fr.Position.Y.Offset
        local xs=fr.Position.X.Scale;   local ys=fr.Position.Y.Scale
        if     pos=="Top"    then ep=UDim2.new(xs,px2,0,-fh-10)
        elseif pos=="Bottom" then ep=UDim2.new(xs,px2,1,fh+10)
        elseif pos=="Left"   then ep=UDim2.new(0,-fw-10,ys,py2)
        else                      ep=UDim2.new(1,fw+10,ys,py2)
        end
        local tt=TS:Create(fr,TweenInfo.new(0.3,Enum.EasingStyle.Quart,Enum.EasingDirection.In),{Position=ep,BackgroundTransparency=1})
        tt:Play(); tt.Completed:Connect(function() fr:Destroy() end)
    end)
end

function Library.CreateWindow()
    local old = CG:FindFirstChild("Library")
    if old then old:Destroy() end

    local sg = new("ScreenGui",{
        Name="Library", ResetOnSpawn=false,
        ZIndexBehavior=Enum.ZIndexBehavior.Sibling,
    }, CG)

    local win = new("Frame",{
        Name="Win",
        Size=UDim2.new(0,640,0,410),
        Position=UDim2.new(0.5,-320,0.5,-205),
        BackgroundColor3=BG, BorderSizePixel=0, ClipsDescendants=true,
    }, sg)
    corner(win,2); stroke(win,BOR,1)

    local fadeOverlay = new("Frame",{
        Size=UDim2.new(1,0,1,0), BackgroundColor3=Color3.fromRGB(0,0,0),
        BackgroundTransparency=1, BorderSizePixel=0, ZIndex=500, Visible=false,
    }, win)

    local visible = true
    UIS.InputBegan:Connect(function(i, gpe)
        if gpe then return end
        if i.KeyCode ~= Enum.KeyCode.Insert then return end
        if visible then
            visible = false
            fadeOverlay.Visible = true
            fadeOverlay.BackgroundTransparency = 1
            tw(fadeOverlay, {BackgroundTransparency=0}, MED)
            task.delay(0.23, function() win.Visible=false; fadeOverlay.Visible=false end)
        else
            visible = true
            win.Visible = true
            fadeOverlay.Visible = true
            fadeOverlay.BackgroundTransparency = 0
            tw(fadeOverlay, {BackgroundTransparency=1}, MED)
            task.delay(0.23, function() fadeOverlay.Visible=false end)
        end
    end)

    local header = new("Frame",{
        Size=UDim2.new(1,0,0,32), BackgroundColor3=BG_H, BorderSizePixel=0, ZIndex=5,
    }, win)
    new("Frame",{
        Size=UDim2.new(1,0,0,1), Position=UDim2.new(0,0,1,-1),
        BackgroundColor3=BOR, BorderSizePixel=0, ZIndex=5,
    }, header)

    do
        local drag=false; local ds,sp2=nil,nil
        header.InputBegan:Connect(function(i)
            if i.UserInputType==Enum.UserInputType.MouseButton1 then
                drag=true; ds=i.Position; sp2=win.Position
            end
        end)
        UIS.InputChanged:Connect(function(i)
            if drag and i.UserInputType==Enum.UserInputType.MouseMovement then
                local d=i.Position-ds
                win.Position=UDim2.new(sp2.X.Scale,sp2.X.Offset+d.X,sp2.Y.Scale,sp2.Y.Offset+d.Y)
            end
        end)
        UIS.InputEnded:Connect(function(i)
            if i.UserInputType==Enum.UserInputType.MouseButton1 then drag=false end
        end)
    end

    local tabRow = new("Frame",{
        Size=UDim2.new(1,0,1,0), BackgroundTransparency=1, ZIndex=6,
    }, header)
    hlist(tabRow,0)

    local content = new("Frame",{
        Size=UDim2.new(1,0,1,-32), Position=UDim2.new(0,0,0,32),
        BackgroundTransparency=1, ClipsDescendants=true,
    }, win)

    local Window    = {}
    local activeTab = nil
    local tabCount  = 0

    local function activateTab(tab)
        if activeTab==tab then return end
        if activeTab then
            activeTab.frame.Visible=false
            tw(activeTab.btn,{TextColor3=TXT_D})
            activeTab.line.BackgroundTransparency=1
        end
        activeTab=tab
        tab.frame.Visible=true
        tw(tab.btn,{TextColor3=TXT_H})
        tab.line.BackgroundTransparency=0
    end

    local dlgOv = new("Frame",{
        Size=UDim2.new(1,0,1,0), BackgroundColor3=Color3.fromRGB(0,0,0),
        BackgroundTransparency=1, BorderSizePixel=0, Visible=false, ZIndex=50,
    }, win)
    local dlgBox = new("Frame",{
        Size=UDim2.new(0,310,0,88), Position=UDim2.new(0.5,-155,0.5,-44),
        BackgroundColor3=BG, BorderSizePixel=0, ZIndex=51,
    }, dlgOv)
    corner(dlgBox,2); stroke(dlgBox,Color3.fromRGB(75,75,78),1)
    local dlgTxt = new("TextLabel",{
        Size=UDim2.new(1,-20,0,38), Position=UDim2.new(0,10,0,10),
        BackgroundTransparency=1, Text="", TextColor3=TXT,
        FontFace=FONT, TextSize=12, TextWrapped=true, ZIndex=52,
    }, dlgBox)
    local dlgY = new("TextButton",{
        Size=UDim2.new(0,80,0,22), Position=UDim2.new(0.5,-86,1,-30),
        BackgroundColor3=ADARK, BorderSizePixel=0,
        Text="Yes", TextColor3=ACC_LT, FontFace=FONT, TextSize=11, AutoButtonColor=false, ZIndex=52,
    }, dlgBox)
    corner(dlgY,1); stroke(dlgY,ACC,1)
    local dlgN = new("TextButton",{
        Size=UDim2.new(0,80,0,22), Position=UDim2.new(0.5,6,1,-30),
        BackgroundColor3=BG_ITEM, BorderSizePixel=0,
        Text="No", TextColor3=TXT, FontFace=FONT, TextSize=11, AutoButtonColor=false, ZIndex=52,
    }, dlgBox)
    corner(dlgN,1); stroke(dlgN,BOR,1)
    local dlgCb=nil
    local function closeDlg(r)
        tw(dlgOv,{BackgroundTransparency=1})
        task.delay(0.16,function() dlgOv.Visible=false end)
        if dlgCb then dlgCb(r); dlgCb=nil end
    end
    dlgY.MouseButton1Click:Connect(function() closeDlg(true) end)
    dlgN.MouseButton1Click:Connect(function() closeDlg(false) end)
    function Window:Dialog(msg, cb)
        dlgTxt.Text=msg; dlgCb=cb
        dlgOv.Visible=true
        tw(dlgOv,{BackgroundTransparency=0.55})
    end

    local function buildSection(container, sName, showTitle)
        local items

        if showTitle then
            local wrapper = new("Frame",{
                Size=UDim2.new(1,0,0,0), BackgroundTransparency=1,
                AutomaticSize=Enum.AutomaticSize.Y,
            }, container)
            vlist(wrapper, 4)

            if sName ~= "" then
                new("TextLabel",{
                    Size=UDim2.new(1,0,0,13), BackgroundTransparency=1,
                    Text=sName:upper(), TextColor3=TXT_D, FontFace=FONT, TextSize=10,
                    TextXAlignment=Enum.TextXAlignment.Left,
                }, wrapper)
            end

            local box = new("Frame",{
                Size=UDim2.new(1,0,0,0), BackgroundColor3=Color3.fromRGB(22,22,24),
                BorderSizePixel=0, AutomaticSize=Enum.AutomaticSize.Y,
            }, wrapper)
            corner(box, 3); stroke(box, Color3.fromRGB(42,42,45), 1)

            items = new("Frame",{
                Size=UDim2.new(1,0,0,0), BackgroundTransparency=1,
                AutomaticSize=Enum.AutomaticSize.Y,
            }, box)
            pad(items, 8, 8, 8, 8); vlist(items, 4)
        else
            items = new("Frame",{
                Size=UDim2.new(1,0,0,0), BackgroundTransparency=1,
                AutomaticSize=Enum.AutomaticSize.Y,
            }, container)
            vlist(items, 4)
        end

        local Section = {}

        function Section:AddSubTabs(tabList, cb)
            local btnRow = new("Frame",{Size=UDim2.new(1,0,0,22),BackgroundTransparency=1},items)
            hlist(btnRow,3)
            local tabs2 = {}
            local activeSub = nil
            for idx, tName in ipairs(tabList) do
                local cont = new("Frame",{
                    Size=UDim2.new(1,0,0,0), BackgroundTransparency=1,
                    AutomaticSize=Enum.AutomaticSize.Y, Visible=(idx==1),
                }, items)
                vlist(cont,3)
                local sb = new("TextButton",{
                    Size=UDim2.new(0,0,1,0), AutomaticSize=Enum.AutomaticSize.X,
                    BackgroundColor3=BG_ITEM, BorderSizePixel=0,
                    Text=tName, TextColor3=TXT_D, FontFace=FONT, TextSize=11,
                    AutoButtonColor=false,
                }, btnRow)
                corner(sb,1); pad(sb,3,3,10,10)
                local ss = stroke(sb,BOR,1)
                tabs2[tName] = {btn=sb, str=ss, cont=cont}
                if idx==1 then
                    activeSub=tName
                    sb.TextColor3=TXT_H; sb.BackgroundColor3=ADARK; ss.Color=ACC
                end
                sb.MouseButton1Click:Connect(function()
                    if activeSub then
                        local prev=tabs2[activeSub]
                        tw(prev.btn,{TextColor3=TXT_D,BackgroundColor3=BG_ITEM})
                        prev.str.Color=BOR; prev.cont.Visible=false
                    end
                    activeSub=tName
                    tw(sb,{TextColor3=TXT_H,BackgroundColor3=ADARK})
                    ss.Color=ACC; cont.Visible=true
                    if cb then cb(tName) end
                end)
            end
            local SubSection={}
            function SubSection:Tab(tName)
                local entry=tabs2[tName]
                if not entry then return end
                return buildSection(entry.cont, "", false)
            end
            return SubSection
        end

        function Section:AddToggle(labelText, default, cb, swatchColor, onSwatchChange)
            local state = default==true
            local row = new("Frame",{Size=UDim2.new(1,0,0,20),BackgroundTransparency=1},items)

            local box = new("Frame",{
                Size=UDim2.new(0,10,0,10), Position=UDim2.new(0,0,0.5,-5),
                BackgroundColor3=state and ACC or BG_IN, BorderSizePixel=0,
            }, row)
            local bs = stroke(box, state and ACC or Color3.fromRGB(75,75,78), 1)
            local tick = new("TextLabel",{
                Size=UDim2.new(1,0,1,0), BackgroundTransparency=1,
                Text="✓", TextColor3=WHITE, FontFace=FONT, TextSize=9,
                TextTransparency=state and 0 or 1,
            }, box)

            local rightMargin = swatchColor and 22 or 4
            new("TextLabel",{
                Size=UDim2.new(1,-(18+rightMargin),1,0), Position=UDim2.new(0,18,0,0),
                BackgroundTransparency=1, Text=labelText, TextColor3=TXT,
                FontFace=FONT, TextSize=13, TextXAlignment=Enum.TextXAlignment.Left,
            }, row)

            if swatchColor then
                local cur = swatchColor
                local pickerOpen = false
                local closePicker = nil
                local sw = new("TextButton",{
                    Size=UDim2.new(0,14,0,10), Position=UDim2.new(1,-16,0.5,-5),
                    BackgroundColor3=cur, BorderSizePixel=0,
                    Text="", AutoButtonColor=false, ZIndex=8,
                }, row)
                corner(sw,2); stroke(sw,Color3.fromRGB(100,100,100),1)
                sw.MouseButton1Click:Connect(function()
                    pickerOpen = not pickerOpen
                    if closePicker then closePicker(); closePicker=nil end
                    if not pickerOpen then return end
                    closePicker = openColorPicker(sg, sw, cur, function(c)
                        cur=c; sw.BackgroundColor3=c
                        pickerOpen=false; closePicker=nil
                        if onSwatchChange then onSwatchChange(c) end
                    end)
                end)
            end

            local caOffsetR = swatchColor and -(18+4) or -4
            local ca = new("TextButton",{
                Size=UDim2.new(1, caOffsetR, 1, 0),
                BackgroundTransparency=1, Text="", ZIndex=5,
            }, row)
            ca.MouseButton1Click:Connect(function()
                state = not state
                tw(box,{BackgroundColor3=state and ACC or BG_IN})
                bs.Color = state and ACC or Color3.fromRGB(75,75,78)
                tick.TextTransparency = state and 0 or 1
                if cb then cb(state) end
            end)

            local T={}
            function T:Set(v)
                state=v
                box.BackgroundColor3=state and ACC or BG_IN
                bs.Color=state and ACC or Color3.fromRGB(75,75,78)
                tick.TextTransparency=state and 0 or 1
            end
            function T:Get() return state end
            return T
        end

        function Section:AddToggle2(labelText, default, cb, swatches)
            local state = default==true
            local swatches = swatches or {}
            local swatchCount = #swatches
            local swatchTotalW = swatchCount * 18 + math.max(0, swatchCount-1) * 4

            local row = new("Frame",{Size=UDim2.new(1,0,0,20),BackgroundTransparency=1},items)

            local box = new("Frame",{
                Size=UDim2.new(0,10,0,10), Position=UDim2.new(0,0,0.5,-5),
                BackgroundColor3=state and ACC or BG_IN, BorderSizePixel=0,
            }, row)
            local bs = stroke(box, state and ACC or Color3.fromRGB(75,75,78), 1)
            local tick = new("TextLabel",{
                Size=UDim2.new(1,0,1,0), BackgroundTransparency=1,
                Text="✓", TextColor3=WHITE, FontFace=FONT, TextSize=9,
                TextTransparency=state and 0 or 1,
            }, box)

            local rightMargin = swatchCount > 0 and (swatchTotalW + 6) or 4
            new("TextLabel",{
                Size=UDim2.new(1,-(18+rightMargin),1,0), Position=UDim2.new(0,18,0,0),
                BackgroundTransparency=1, Text=labelText, TextColor3=TXT,
                FontFace=FONT, TextSize=13, TextXAlignment=Enum.TextXAlignment.Left,
            }, row)

            local swatchOffsetX = -(swatchTotalW + 2)
            for idx, swDef in ipairs(swatches) do
                local initColor = swDef.color or Color3.fromRGB(255,255,255)
                local swCb      = swDef.cb
                local cur       = initColor
                local pickerOpen = false
                local closePicker = nil

                local posX = swatchOffsetX + (idx-1) * 22
                local sw = new("TextButton",{
                    Size=UDim2.new(0,14,0,10),
                    Position=UDim2.new(1, posX, 0.5, -5),
                    BackgroundColor3=cur, BorderSizePixel=0,
                    Text="", AutoButtonColor=false, ZIndex=8,
                }, row)
                corner(sw,2); stroke(sw,Color3.fromRGB(100,100,100),1)

                sw.MouseButton1Click:Connect(function()
                    pickerOpen = not pickerOpen
                    if closePicker then closePicker(); closePicker=nil end
                    if not pickerOpen then return end
                    closePicker = openColorPicker(sg, sw, cur, function(c)
                        cur=c; sw.BackgroundColor3=c
                        pickerOpen=false; closePicker=nil
                        if swCb then swCb(c) end
                    end)
                end)
            end

            local caOffsetR = swatchCount > 0 and -(swatchTotalW + 6) or -4
            local ca = new("TextButton",{
                Size=UDim2.new(1, caOffsetR, 1, 0),
                BackgroundTransparency=1, Text="", ZIndex=5,
            }, row)
            ca.MouseButton1Click:Connect(function()
                state = not state
                tw(box,{BackgroundColor3=state and ACC or BG_IN})
                bs.Color = state and ACC or Color3.fromRGB(75,75,78)
                tick.TextTransparency = state and 0 or 1
                if cb then cb(state) end
            end)

            local T={}
            function T:Set(v)
                state=v
                box.BackgroundColor3=state and ACC or BG_IN
                bs.Color=state and ACC or Color3.fromRGB(75,75,78)
                tick.TextTransparency=state and 0 or 1
            end
            function T:Get() return state end
            return T
        end

        function Section:AddSlider(labelText, minV, maxV, defV, cb, sfx)
            local wrap = new("Frame",{Size=UDim2.new(1,0,0,32),BackgroundTransparency=1},items)
            new("TextLabel",{
                Size=UDim2.new(1,0,0,13), BackgroundTransparency=1,
                Text=labelText, TextColor3=TXT_D, FontFace=FONT, TextSize=10,
                TextXAlignment=Enum.TextXAlignment.Left,
            },wrap)
            local track = new("Frame",{
                Size=UDim2.new(1,0,0,4), Position=UDim2.new(0,0,0,19),
                BackgroundColor3=Color3.fromRGB(42,42,44), BorderSizePixel=0,
            },wrap)
            local fill  = new("Frame",{Size=UDim2.new(0,0,1,0),BackgroundColor3=ACC,BorderSizePixel=0},track)
            local vLbl  = new("TextLabel",{
                Size=UDim2.new(0,40,0,12), Position=UDim2.new(1,-40,0,18),
                BackgroundTransparency=1, Text="", TextColor3=TXT_D,
                FontFace=FONT, TextSize=10, TextXAlignment=Enum.TextXAlignment.Right,
            },wrap)
            return makeSlider(track,fill,vLbl,minV,maxV,defV,sfx,cb,sg)
        end

        function Section:AddDropdown(labelText, options, default, cb)
            local sel=default or options[1]; local open=false
            local wrap=new("Frame",{
                Size=UDim2.new(1,0,0,42), BackgroundTransparency=1,
                ClipsDescendants=false, ZIndex=3,
            },items)
            new("TextLabel",{
                Size=UDim2.new(1,0,0,13), BackgroundTransparency=1,
                Text=labelText, TextColor3=TXT_D, FontFace=FONT, TextSize=10,
                TextXAlignment=Enum.TextXAlignment.Left, ZIndex=3,
            },wrap)
            local selBtn=new("TextButton",{
                Size=UDim2.new(1,0,0,22), Position=UDim2.new(0,0,0,15),
                BackgroundColor3=BG_IN, BorderSizePixel=0,
                Text=sel.."  v", TextColor3=TXT, FontFace=FONT, TextSize=11,
                TextXAlignment=Enum.TextXAlignment.Left, AutoButtonColor=false, ZIndex=4,
            },wrap)
            pad(selBtn,0,0,7,0); stroke(selBtn,BOR,1)
            local listF=new("Frame",{
                Size=UDim2.new(1,0,0,0), Position=UDim2.new(0,0,0,38),
                BackgroundColor3=BG_IN, BorderSizePixel=0,
                ClipsDescendants=true, ZIndex=20, Visible=false,
            },wrap)
            stroke(listF,BOR,1); vlist(listF,0)
            local function closeDD()
                open=false
                tw(listF,{Size=UDim2.new(1,0,0,0)})
                task.delay(0.16,function() if not open then listF.Visible=false end end)
                wrap.Size=UDim2.new(1,0,0,42)
            end
            for _,opt in ipairs(options) do
                local ob=new("TextButton",{
                    Size=UDim2.new(1,0,0,20), BackgroundTransparency=1,
                    Text=opt, TextColor3=opt==sel and ACC_LT or TXT,
                    FontFace=FONT, TextSize=11, TextXAlignment=Enum.TextXAlignment.Left,
                    AutoButtonColor=false, ZIndex=21,
                },listF)
                pad(ob,0,0,8,0)
                ob.MouseEnter:Connect(function() ob.BackgroundTransparency=0; ob.BackgroundColor3=Color3.fromRGB(38,12,12) end)
                ob.MouseLeave:Connect(function() ob.BackgroundTransparency=1 end)
                ob.MouseButton1Click:Connect(function()
                    sel=opt; selBtn.Text=opt.."  v"
                    for _,c in ipairs(listF:GetChildren()) do
                        if c:IsA("TextButton") then c.TextColor3=(c.Text==opt) and ACC_LT or TXT end
                    end
                    if cb then cb(opt) end; closeDD()
                end)
            end
            selBtn.MouseButton1Click:Connect(function()
                open=not open
                if open then
                    listF.Visible=true
                    tw(listF,{Size=UDim2.new(1,0,0,#options*20)})
                    wrap.Size=UDim2.new(1,0,0,42+#options*20)
                else closeDD() end
            end)
            local D={}
            function D:Set(v) sel=v; selBtn.Text=v.."  v" end
            function D:Get() return sel end
            return D
        end

        function Section:AddMultibox(labelText, options, defaults, cb)
            local checked={}
            for _,opt in ipairs(options) do
                checked[opt]=defaults and (table.find(defaults,opt)~=nil) or false
            end
            local open=false
            local function getLabel()
                local s={}
                for _,opt in ipairs(options) do if checked[opt] then table.insert(s,opt) end end
                return #s==0 and "None" or table.concat(s,", ")
            end
            local wrap=new("Frame",{
                Size=UDim2.new(1,0,0,42), BackgroundTransparency=1,
                ClipsDescendants=false, ZIndex=3,
            },items)
            new("TextLabel",{
                Size=UDim2.new(1,0,0,13), BackgroundTransparency=1,
                Text=labelText, TextColor3=TXT_D, FontFace=FONT, TextSize=10,
                TextXAlignment=Enum.TextXAlignment.Left, ZIndex=3,
            },wrap)
            local selBtn=new("TextButton",{
                Size=UDim2.new(1,0,0,22), Position=UDim2.new(0,0,0,15),
                BackgroundColor3=BG_IN, BorderSizePixel=0,
                Text=getLabel().."  v", TextColor3=TXT, FontFace=FONT, TextSize=11,
                TextXAlignment=Enum.TextXAlignment.Left, AutoButtonColor=false, ZIndex=4,
            },wrap)
            pad(selBtn,0,0,7,0); stroke(selBtn,BOR,1)
            local listF=new("Frame",{
                Size=UDim2.new(1,0,0,0), Position=UDim2.new(0,0,0,38),
                BackgroundColor3=BG_IN, BorderSizePixel=0,
                ClipsDescendants=true, ZIndex=20, Visible=false,
            },wrap)
            stroke(listF,BOR,1); vlist(listF,0)
            local function closeMB()
                open=false
                tw(listF,{Size=UDim2.new(1,0,0,0)})
                task.delay(0.16,function() if not open then listF.Visible=false end end)
                wrap.Size=UDim2.new(1,0,0,42)
            end
            for _,opt in ipairs(options) do
                local r2=new("Frame",{Size=UDim2.new(1,0,0,22),BackgroundTransparency=1,ZIndex=21},listF)
                local b2=new("Frame",{
                    Size=UDim2.new(0,9,0,9), Position=UDim2.new(0,8,0.5,-4),
                    BackgroundColor3=checked[opt] and ACC or BG_IN, BorderSizePixel=0, ZIndex=22,
                },r2)
                local bs2=stroke(b2,checked[opt] and ACC or Color3.fromRGB(75,75,78),1)
                local tk2=new("TextLabel",{
                    Size=UDim2.new(1,0,1,0), BackgroundTransparency=1,
                    Text="v", TextColor3=WHITE, FontFace=FONT, TextSize=8,
                    TextTransparency=checked[opt] and 0 or 1, ZIndex=23,
                },b2)
                new("TextLabel",{
                    Size=UDim2.new(1,-26,1,0), Position=UDim2.new(0,24,0,0),
                    BackgroundTransparency=1, Text=opt, TextColor3=TXT,
                    FontFace=FONT, TextSize=11, TextXAlignment=Enum.TextXAlignment.Left, ZIndex=22,
                },r2)
                local rb=new("TextButton",{Size=UDim2.new(1,0,1,0),BackgroundTransparency=1,Text="",ZIndex=24},r2)
                rb.MouseEnter:Connect(function() r2.BackgroundTransparency=0; r2.BackgroundColor3=Color3.fromRGB(36,12,12) end)
                rb.MouseLeave:Connect(function() r2.BackgroundTransparency=1 end)
                rb.MouseButton1Click:Connect(function()
                    checked[opt]=not checked[opt]
                    b2.BackgroundColor3=checked[opt] and ACC or BG_IN
                    bs2.Color=checked[opt] and ACC or Color3.fromRGB(75,75,78)
                    tk2.TextTransparency=checked[opt] and 0 or 1
                    selBtn.Text=getLabel().."  v"
                    if cb then cb(checked) end
                end)
            end
            selBtn.MouseButton1Click:Connect(function()
                open=not open
                if open then
                    listF.Visible=true
                    tw(listF,{Size=UDim2.new(1,0,0,#options*22)})
                    wrap.Size=UDim2.new(1,0,0,42+#options*22)
                else closeMB() end
            end)
            local M={}
            function M:Get() return checked end
            function M:SetOption(opt,v) checked[opt]=v; selBtn.Text=getLabel().."  v" end
            return M
        end

        function Section:AddKeybind(labelText, default, cb)
            local key = default or ""
            local waiting = false
            local lc = nil

            local IGNORED_KEYS = {
                Unknown=true, Escape=true,
                LeftShift=true, RightShift=true,
                LeftControl=true, RightControl=true,
                LeftAlt=true, RightAlt=true,
                LeftMeta=true, RightMeta=true,
                CapsLock=true, NumLock=true, ScrollLock=true,
            }

            local MOUSE_NAMES = {
                [Enum.UserInputType.MouseButton1] = "MB1",
                [Enum.UserInputType.MouseButton2] = "MB2",
                [Enum.UserInputType.MouseButton3] = "MB3",
            }

            local wrap = new("Frame",{Size=UDim2.new(1,0,0,42),BackgroundTransparency=1},items)
            new("TextLabel",{
                Size=UDim2.new(1,0,0,13), BackgroundTransparency=1,
                Text=labelText, TextColor3=TXT_D, FontFace=FONT, TextSize=10,
                TextXAlignment=Enum.TextXAlignment.Left,
            },wrap)
            local bb = new("TextButton",{
                Size=UDim2.new(0.6,0,0,22), Position=UDim2.new(0,0,0,15),
                BackgroundColor3=BG_IN, BorderSizePixel=0,
                Text=key=="" and "[ ... ]" or "[ "..key.." ]",
                TextColor3=TXT, FontFace=FONT, TextSize=11, AutoButtonColor=false,
            },wrap)
            stroke(bb,BOR,1)
            local xb = new("TextButton",{
                Size=UDim2.new(0,18,0,18), Position=UDim2.new(0.6,4,0,17),
                BackgroundColor3=BG_ITEM, BorderSizePixel=0,
                Text="x", TextColor3=TXT_D, FontFace=FONT, TextSize=10,
                AutoButtonColor=false, Visible=key~="",
            },wrap)
            corner(xb,1)

            local function capture(name)
                key = name
                bb.Text = "[ "..key.." ]"
                bb.TextColor3 = TXT
                xb.Visible = true
                waiting = false
                if lc then lc:Disconnect(); lc=nil end
                if cb then cb(key) end
            end

            bb.MouseButton1Click:Connect(function()
                if waiting then
                    waiting = false
                    bb.Text = key=="" and "[ ... ]" or "[ "..key.." ]"
                    bb.TextColor3 = TXT
                    if lc then lc:Disconnect(); lc=nil end
                    return
                end
                waiting = true
                bb.Text = "[ ? ]"
                bb.TextColor3 = ACC_LT
                if lc then lc:Disconnect() end
                lc = UIS.InputBegan:Connect(function(i, gpe)
                    if not waiting then return end
                    local mt = MOUSE_NAMES[i.UserInputType]
                    if mt then
                        capture(mt)
                        return
                    end
                    if i.UserInputType == Enum.UserInputType.Keyboard then
                        local kn = i.KeyCode.Name
                        if IGNORED_KEYS[kn] then return end
                        capture(kn)
                    end
                end)
            end)

            xb.MouseButton1Click:Connect(function()
                key = ""
                bb.Text = "[ ... ]"
                xb.Visible = false
                if cb then cb(key) end
            end)

            local K = {}
            function K:Get() return key end
            function K:Set(v) key=v; bb.Text=v=="" and "[ ... ]" or "[ "..v.." ]"; xb.Visible=v~="" end
            return K
        end

        function Section:AddColorPicker(labelText, defaultColor, cb)
            local color = defaultColor or Color3.fromRGB(255,255,255)
            local pickerOpen = false
            local closePicker = nil
            local row=new("Frame",{Size=UDim2.new(1,0,0,20),BackgroundTransparency=1},items)
            new("TextLabel",{
                Size=UDim2.new(1,-30,1,0), BackgroundTransparency=1,
                Text=labelText, TextColor3=TXT, FontFace=FONT, TextSize=13,
                TextXAlignment=Enum.TextXAlignment.Left,
            },row)
            local swatch=new("TextButton",{
                Size=UDim2.new(0,22,0,12), Position=UDim2.new(1,-22,0.5,-6),
                BackgroundColor3=color, BorderSizePixel=0,
                Text="", AutoButtonColor=false, ZIndex=5,
            },row)
            corner(swatch,1); stroke(swatch,Color3.fromRGB(60,60,62),1)
            swatch.MouseButton1Click:Connect(function()
                pickerOpen = not pickerOpen
                if closePicker then closePicker(); closePicker=nil end
                if not pickerOpen then return end
                closePicker = openColorPicker(sg, swatch, color, function(c)
                    color=c; swatch.BackgroundColor3=c
                    pickerOpen=false; closePicker=nil
                    if cb then cb(c) end
                end)
            end)
            local CP={}
            function CP:Set(c) color=c; swatch.BackgroundColor3=c end
            function CP:Get() return color end
            return CP
        end

        function Section:AddButton(labelText, cb, danger)
            local btn=new("TextButton",{
                Size=UDim2.new(1,0,0,24), BackgroundColor3=BG_ITEM, BorderSizePixel=0,
                Text=labelText, TextColor3=TXT, FontFace=FONT, TextSize=11, AutoButtonColor=false,
            },items)
            corner(btn,1)
            local bs=stroke(btn,BOR,1)
            btn.MouseEnter:Connect(function()
                if danger then tw(btn,{TextColor3=ACC_LT,BackgroundColor3=Color3.fromRGB(40,12,12)}); bs.Color=ACC
                else tw(btn,{TextColor3=TXT_H,BackgroundColor3=Color3.fromRGB(38,38,40)}) end
            end)
            btn.MouseLeave:Connect(function()
                tw(btn,{TextColor3=TXT,BackgroundColor3=BG_ITEM})
                if danger then bs.Color=BOR end
            end)
            btn.MouseButton1Click:Connect(function()
                tw(btn,{BackgroundColor3=Color3.fromRGB(50,14,14)})
                task.delay(0.12,function() tw(btn,{BackgroundColor3=BG_ITEM}) end)
                if cb then cb() end
            end)
        end

        function Section:AddLabel(text)
            new("TextLabel",{
                Size=UDim2.new(1,0,0,16), BackgroundTransparency=1,
                Text=text, TextColor3=TXT_D, FontFace=FONT, TextSize=10,
                TextXAlignment=Enum.TextXAlignment.Left,
            },items)
        end

        function Section:AddSeparator()
            new("Frame",{Size=UDim2.new(1,0,0,1),BackgroundColor3=BOR,BorderSizePixel=0},items)
        end

        function Section:AddProfileList(profileList, cb)
            local h=math.min(#profileList*22,160)
            local cont=new("ScrollingFrame",{
                Size=UDim2.new(1,0,0,h), BackgroundColor3=BG_IN, BorderSizePixel=0,
                ScrollBarThickness=2, ScrollBarImageColor3=BOR,
                CanvasSize=UDim2.new(0,0,0,0), AutomaticCanvasSize=Enum.AutomaticSize.Y,
            },items)
            stroke(cont,BOR,1); vlist(cont,0)
            local selP=nil
            for _,pName in ipairs(profileList) do
                local pb=new("TextButton",{
                    Size=UDim2.new(1,0,0,22), BackgroundTransparency=1,
                    Text=pName, TextColor3=TXT, FontFace=FONT, TextSize=12,
                    TextXAlignment=Enum.TextXAlignment.Left, AutoButtonColor=false,
                },cont)
                pad(pb,0,0,10,0)
                pb.MouseEnter:Connect(function() if selP~=pb then pb.BackgroundTransparency=0; pb.BackgroundColor3=Color3.fromRGB(36,36,38) end end)
                pb.MouseLeave:Connect(function() if selP~=pb then pb.BackgroundTransparency=1 end end)
                pb.MouseButton1Click:Connect(function()
                    if selP then selP.TextColor3=TXT; selP.BackgroundTransparency=1 end
                    selP=pb; pb.TextColor3=ACC_LT; pb.BackgroundTransparency=0
                    pb.BackgroundColor3=Color3.fromRGB(40,12,12)
                    if cb then cb(pName) end
                end)
            end
        end

        return Section
    end

    function Window:AddTab(name)
        tabCount=tabCount+1
        local tab={}
        local btn=new("TextButton",{
            Size=UDim2.new(0,128,1,0), BackgroundTransparency=1,
            Text=name, TextColor3=TXT_D, FontFace=FONT, TextSize=12,
            AutoButtonColor=false, BorderSizePixel=0, ZIndex=6,
        },tabRow)
        local line=new("Frame",{
            Size=UDim2.new(1,0,0,1), Position=UDim2.new(0,0,1,-1),
            BackgroundColor3=ACC, BackgroundTransparency=1, BorderSizePixel=0, ZIndex=7,
        },btn)
        new("Frame",{
            Size=UDim2.new(0,1,1,0), Position=UDim2.new(1,-1,0,0),
            BackgroundColor3=BOR, BorderSizePixel=0, ZIndex=6,
        },btn)
        local frame=new("Frame",{Size=UDim2.new(1,0,1,0),BackgroundTransparency=1,Visible=false},content)
        local lS=new("ScrollingFrame",{
            Size=UDim2.new(0.5,-1,1,0), BackgroundTransparency=1, BorderSizePixel=0,
            ScrollBarThickness=2, ScrollBarImageColor3=BOR,
            CanvasSize=UDim2.new(0,0,0,0), AutomaticCanvasSize=Enum.AutomaticSize.Y,
        },frame)
        pad(lS,12,12,14,14); vlist(lS,6)
        new("Frame",{Size=UDim2.new(0,1,1,0),Position=UDim2.new(0.5,0,0,0),BackgroundColor3=BOR,BorderSizePixel=0},frame)
        local rS=new("ScrollingFrame",{
            Size=UDim2.new(0.5,-1,1,0), Position=UDim2.new(0.5,1,0,0),
            BackgroundTransparency=1, BorderSizePixel=0,
            ScrollBarThickness=2, ScrollBarImageColor3=BOR,
            CanvasSize=UDim2.new(0,0,0,0), AutomaticCanvasSize=Enum.AutomaticSize.Y,
        },frame)
        pad(rS,12,12,14,14); vlist(rS,6)
        tab.btn=btn; tab.line=line; tab.frame=frame; tab.left=lS; tab.right=rS
        btn.MouseButton1Click:Connect(function() activateTab(tab) end)
        btn.MouseEnter:Connect(function() if activeTab~=tab then tw(btn,{TextColor3=TXT}) end end)
        btn.MouseLeave:Connect(function() if activeTab~=tab then tw(btn,{TextColor3=TXT_D}) end end)
        if tabCount==1 then activateTab(tab) end
        local Tab={}
        function Tab:AddSection(sName, side)
            local panel=(side=="Right") and rS or lS
            return buildSection(panel, sName, true)
        end
        return Tab
    end

    return Window
end

return Library
